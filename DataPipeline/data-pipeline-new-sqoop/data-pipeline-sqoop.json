{
    "Resources": {
        "DPP4706J": {
            "Type": "AWS::DataPipeline::Pipeline",
            "Properties": {
                "Activate": true,
                "Description": "Pipeline criado automaticamente",
                "Name": {
                    "Ref": "myDataPipelineName"
                },
                "PipelineObjects": [
                    {
                        "Id": "Default",
                        "Name": "Default",
                        "Fields": [
                            {
                                "Key": "resourceRole",
                                "StringValue": "DataPipelineDefaultResourceRole"
                            },
                            {
                                "Key": "role",
                                "StringValue": "DataPipelineDefaultRole"
                            },
                            {
                                "Key": "scheduleType",
                                "StringValue": "cron"
                            },
                            {
                                "Key": "schedule",
                                "RefValue": "DefaultSchedule"
                            },
                            {
                                "Key": "type",
                                "StringValue": "Default"
                            },
                            {
                                "Key": "pipelineLogUri",
                                "StringValue": {
                                    "Ref": "myS3PipelineLogUrl"
                                }
                            }
                        ]
                    },
                    {
                        "Id": "DefaultSchedule",
                        "Name": "RunEachNight",
                        "Fields": [
                            {
                                "Key": "startAt",
                                "StringValue": "FIRST_ACTIVATION_DATE_TIME"
                            },
                            {
                                "Key": "type",
                                "StringValue": "Schedule"
                            },
                            {
                                "Key": "period",
                                "StringValue": "1 Day"
                            }
                        ]
                    },
                    {
                        "Id": "SqoopActivity",
                        "Name": "SqoopActivity",
                        "Fields": [
                            {
                                "Key": "workerGroup",
                                "StringValue": "sqoopJob"
                            },
                            {
                                "Key": "type",
                                "StringValue": "ShellCommandActivity"
                            },
                            {
                                "Key": "command",
                                "StringValue": {
                                    "Fn::Join": [
                                        " ",
                                        [
                                            "python3",
                                            {
                                                "Ref": "myPythonScript"
                                            },
                                            {
                                                "Ref": "myPythonScriptProp"
                                            },
                                            {
                                                "Ref": "myTableIngestion"
                                            }
                                        ]
                                    ]
                                }
                            }
                        ]
                    }
                ]
            }
        }
    },
    "Parameters": {
        "myS3PipelineLogUrl": {
            "Type": "String",
            "Description": "S3 folder where log data generated by this pipeline will be written"
        },
        "myDataPipelineName": {
            "Type": "String",
            "Description": "Data pipeline name"
        },
        "myPythonScript": {
            "Type": "String",
            "Description": "Python script name"
        },
        "myPythonScriptProp": {
            "Type": "String",
            "Description": "Python script properties path"
        },
        "myTableIngestion": {
            "Type": "String",
            "Description": "Table name to ingest"
        }
    }
}